"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getBalance = void 0;
const tslib_1 = require("tslib");
const utils_1 = require("@rarible/utils");
function getBalance(env, apis, address, assetType) {
    return tslib_1.__awaiter(this, void 0, void 0, function* () {
        const DEFAULT_DECIMALS = 18;
        const { result } = yield apis.balance.getAllBalances({ ownerAddress: address });
        if (assetType.assetClass === "ETH") {
            const currencyBalance = result.find(b => b.token_address === "");
            if (currencyBalance) {
                return (0, utils_1.toBn)(currencyBalance.balance.toString()).dividedBy(Math.pow(10, DEFAULT_DECIMALS));
            }
        }
        else if (assetType.assetClass === "ERC20") {
            const currencyBalance = result.find(b => { var _a; return ((_a = b.token_address) === null || _a === void 0 ? void 0 : _a.toLowerCase()) === assetType.contract.toLowerCase(); });
            if (currencyBalance) {
                return (0, utils_1.toBn)(currencyBalance.balance.toString()).dividedBy(Math.pow(10, DEFAULT_DECIMALS));
            }
        }
        return (0, utils_1.toBn)("0");
    });
}
exports.getBalance = getBalance;
