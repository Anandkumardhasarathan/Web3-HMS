"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getBaseFee = void 0;
const tslib_1 = require("tslib");
const sdk_common_1 = require("@rarible/sdk-common");
const retry_1 = require("./retry");
function getBaseFee(env, getApis, type) {
    return tslib_1.__awaiter(this, void 0, void 0, function* () {
        const apis = yield getApis();
        let envFeeConfig;
        try {
            const fees = yield (0, retry_1.retry)(5, 3000, () => tslib_1.__awaiter(this, void 0, void 0, function* () { return yield apis.orderSettings.getFees(); }));
            envFeeConfig = fees.fees;
        }
        catch (e) {
            let errorJson;
            try {
                errorJson = (0, sdk_common_1.getStringifiedData)(e);
            }
            catch (e) { }
            throw new Error(`Getting fee error ${errorJson}`);
        }
        if (!envFeeConfig) {
            throw new Error(`Fee config was not found for ${env}`);
        }
        if (!(type in envFeeConfig)) {
            throw new Error(`Unsupported fee type ${type}`);
        }
        return Number(envFeeConfig[type] || 0);
    });
}
exports.getBaseFee = getBaseFee;
