"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getCommonConvertableValue = void 0;
const tslib_1 = require("tslib");
const bignumber_js_1 = tslib_1.__importDefault(require("bignumber.js"));
function getCommonConvertableValue(getBalance, walletAddress, valueWithFee, from, to) {
    return tslib_1.__awaiter(this, void 0, void 0, function* () {
        const wrappedTokenBalance = yield getBalance(walletAddress, to);
        if (new bignumber_js_1.default(wrappedTokenBalance).gte(valueWithFee)) {
            return undefined;
        }
        const fromBalance = yield getBalance(walletAddress, from);
        if (new bignumber_js_1.default(fromBalance).plus(wrappedTokenBalance).gte(valueWithFee)) {
            return {
                type: "convertable",
                currency: from,
                value: new bignumber_js_1.default(valueWithFee).minus(wrappedTokenBalance),
            };
        }
        return {
            type: "insufficient",
            currency: from,
            value: new bignumber_js_1.default(valueWithFee).minus(fromBalance),
        };
    });
}
exports.getCommonConvertableValue = getCommonConvertableValue;
