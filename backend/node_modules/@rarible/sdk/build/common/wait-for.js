"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.waitFor = void 0;
const tslib_1 = require("tslib");
const retry_1 = require("./retry");
function waitFor(promise_1, predicate_1) {
    return tslib_1.__awaiter(this, arguments, void 0, function* (promise, predicate, interval = 1000) {
        return (0, retry_1.retry)(20, interval, () => tslib_1.__awaiter(this, void 0, void 0, function* () {
            const result = yield promise();
            if (predicate) {
                if (!predicate(result)) {
                    throw new Error(`Predicate is not matched: expected ${JSON.stringify(result)}`);
                }
            }
            return result;
        }));
    });
}
exports.waitFor = waitFor;
