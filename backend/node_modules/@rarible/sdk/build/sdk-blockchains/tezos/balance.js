"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.TezosBalance = void 0;
const tslib_1 = require("tslib");
// eslint-disable-next-line camelcase
const tezos_sdk_1 = require("@rarible/tezos-sdk");
const bignumber_js_1 = tslib_1.__importDefault(require("bignumber.js"));
const get_currency_asset_type_1 = require("../../common/get-currency-asset-type");
const common_1 = require("./common");
class TezosBalance {
    constructor(provider, network) {
        this.provider = provider;
        this.network = network;
        this.getBalance = this.getBalance.bind(this);
    }
    getBalance(address, currency) {
        return tslib_1.__awaiter(this, void 0, void 0, function* () {
            const assetType = (0, get_currency_asset_type_1.getCurrencyAssetType)(currency);
            const tezosAssetType = yield (0, common_1.getTezosAssetTypeV2)(this.provider.config, assetType);
            if (assetType["@type"] !== "XTZ" && assetType["@type"] !== "TEZOS_FT") {
                throw new Error("Unsupported asset type");
            }
            if (!this.provider.config.node_url) {
                throw new Error("Node url for tezos has not been specified");
            }
            return new bignumber_js_1.default(yield (0, tezos_sdk_1.get_balance)(this.provider.config, (0, common_1.getTezosAddress)(address), tezosAssetType.type, tezosAssetType.asset_contract, tezosAssetType.asset_token_id));
        });
    }
}
exports.TezosBalance = TezosBalance;
